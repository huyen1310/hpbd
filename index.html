<!DOCTYPE html>
<html lang="en">


<!-- Mirrored from love.tsonit.com/sunn by HTTrack Website Copier/3.x [XR&CO'2017], Mon, 23 Jun 2025 07:54:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I love you - LoveLoom</title>
    <meta name="description" content="I love you">
    <meta property="og:title" content="I love you - LoveLoom">
    <meta property="og:description" content="">
    <meta property="og:image" content="love.jpg">
    <meta property="og:url" content="sunn.html">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="icon" type="image/png" href="love.png" sizes="16x16">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="../cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        .text-white {
            color: white !important;
        }

        .btn-audio-toggle {
            background-color: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
        }

        .music-status {
            display: flex;
            position: fixed;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            z-index: 9999;
            align-items: center;
            font-family: sans-serif;
            font-size: 14px;
        }

        .music-status .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #a259f7;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        body.portrait-mode #landscape-warning {
            display: flex;
            opacity:1;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
    <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.152.2/build/three.module.js",
        "three/addons/controls/OrbitControls.js": "https://unpkg.com/three@0.152.2/examples/jsm/controls/OrbitControls.js",
        "three/examples/jsm/loaders/FontLoader.js": "https://unpkg.com/three@0.152.2/examples/jsm/loaders/FontLoader.js",
        "three/examples/jsm/geometries/TextGeometry.js": "https://unpkg.com/three@0.152.2/examples/jsm/geometries/TextGeometry.js"
      }
    }
    </script>
</head>

<body>

    <div id="container"></div>
    <div id="music-loader" class="music-status">
        <div class="spinner"></div>
        <span>Đang tải dữ liệu...</span>
    </div>
    
    <div id="landscape-warning">
        <div class="warning-content">
            <div class="rotate-icon"></div>
            <h1>LoveLoom</h1>
            <h1>Tinh Cầu</h1>
            <p style="font-size: 0.6em;">Cậu hãy xoay ngang màn hình nha để thấy điều kỳ diệu!</p>
            <p style="font-size: 0.6em;">Nhớ chạm vào tinh cầu ở giữa để mở quà bí mật nha.</p>
            <p style="font-size: 1.4em;">love.tsonit.com</p>
            <div class="stars-bg"></div>
        </div>
    </div>
    <div id="dark-overlay"></div>
    <div id="info">

    </div>
            
        <script>
            window.dataLove2Loveloom = {"template":"galaxy","data":{"keychain":{"name":"Loveloom","phone":"Loveloom","address":"Loveloom"},"ringTexts":["I love you"],"heartImages":["https:\/\/loveloom.click\/view\/3:AgACAgUAAyEGAASsk8AHAAJlAAFoWK_1bfxsB1vPiTbvxU9meh0H9AACMsgxGzs5yVaPxe00xcd4KgEAAwIAA3kAAzYE.jpg","sunn.html\/\/loveloom.click\/view\/2:AgACAgUAAyEGAASjr4jMAAJlv2hYySQ_rh8LECBkXmwP_QWmtiqPAALqxTEbUxHIVki2NDaQXSMFAQADAgADeQADNgQ.jpg","sunn.html\/\/loveloom.click\/view\/3:AgACAgUAAyEGAASsk8AHAAJlnmhYySIbwqSEyuSRucHG8vN8aih2AALzyDEbOznJVm9dxb3whUCKAQADAgADeQADNgQ.jpg","sunn.html\/\/loveloom.click\/view\/0:AgACAgUAAyEGAASn1Y1gAAJkomhYyR-BZIRzYrWjgKVR-8jf6fkFAAINyDEbKZvIVkmrAxDLDLVZAQADAgADeAADNgQ.jpg","sunn.html\/\/loveloom.click\/view\/3:AgACAgUAAyEGAASsk8AHAAJlnWhYyR1HO7oH__hXqZWqj14mGzrtAALyyDEbOznJVh-N8lGBXjv9AQADAgADdwADNgQ.jpg","sunn.html\/\/loveloom.click\/view\/1:AgACAgUAAyEGAASiN5Z0AAJl8mhYyRoW74Vt-Jvb9nYT3gFfH3hkAAKbwzEbWezIVuJNxud2C16cAQADAgADeQADNgQ.jpg","sunn.html\/\/loveloom.click\/view\/0:AgACAgUAAyEGAASn1Y1gAAJkoWhYyRkn5EDqOBF1ZbtZOoPmuPGxAAIMyDEbKZvIVtZr0s1NMKiSAQADAgADeQADNgQ.jpg","sunn.html\/\/loveloom.click\/view\/3:AgACAgUAAyEGAASsk8AHAAJlnGhYyRcgoonmCUt7yWehDf4tey8xAALwyDEbOznJVibxJ7e0yoceAQADAgADeQADNgQ.jpg","https:\/\/loveloom.click\/view\/0:AgACAgUAAyEGAASn1Y1gAAJkoGhYyRWcXT0tGYCbYB6Q9Rb6LNAmAAILyDEbKZvIVrvPcXh9nTrdAQADAgADeQADNgQ.jpg"],"type_music":"system","music_id":"\/musics\/phepmau.mp3","backgroundMusic":"\/storage\/musics\/phepmau.mp3"}};
        </script>
        <script type="module" src="assets/love2/script4c7c.js"></script>
    <button id="toggle-audio" class="text-white btn-audio-toggle"
        style="position: absolute; top: 10px; right: 10px; z-index: 999;">
        <i id="audio-icon" class="text-white  fa-solid fa-volume-high"></i>
    </button>
    <script>
        // --- MODULE QUẢN LÝ ÂM THANH ---
        const musicManager = {
            // Properties
            audio: null,
            state: 'idle', // idle, loading, ready, playing, paused, muted, error
            tokenData: null,

            // --- Core Functions ---
             _setupAudio() {
                let audioSrc = window.dataLove2Loveloom?.data?.backgroundMusic;
                if (!audioSrc) { // Nhạc dự phòng cuối cùng
                    audioSrc = 'storage/musics/CjfFFwHK4iTik1AjrDa33PT3waZm4Bv1qFreni4e.mp3';
                }
                this.audio = new Audio(audioSrc);
                this.audio.loop = true;
                this.audio.volume = 0.7;
                this.attachEventListeners();
                window.galaxyAudio = this.audio; // Gán vào global để script.js dùng
                this.updateState('ready'); // Báo rằng nhạc đã sẵn sàng để phát
            },
        
            async init() {
                const musicData = window.dataLove2Loveloom.data;
                this.updateState('loading'); // Luôn bắt đầu với trạng thái loading
        
                if (musicData.type_music === 'system') {
                    this._setupAudio(); // Tạo audio ngay lập tức với nhạc hệ thống
                } else if (musicData.type_music === 'zing' && musicData.music_id) {
                    try {
                        const res = await this.fetchWithAuth(`/get-song?id=${musicData.music_id}`);
                        if (!res.ok) throw new Error('Response not OK');
                        const songInfo = await res.json();
                        const mp3Url = songInfo.stream?.['128'];
        
                        if (mp3Url) {
                            window.dataLove2Loveloom.data.backgroundMusic = mp3Url;
                            this._setupAudio(); // Tạo audio sau khi lấy link Zing thành công
                        } else {
                            console.error('Không tìm thấy link MP3 128kbps, dùng nhạc dự phòng.');
                            this._setupAudio(); // Lỗi -> Dùng nhạc dự phòng
                        }
                    } catch (error) {
                        console.error('Lỗi khi lấy nhạc từ Zing:', error);
                        this.updateState('error');
                        this._setupAudio(); // Lỗi -> Dùng nhạc dự phòng
                    }
                } else {
                    this._setupAudio(); // Trường hợp mặc định
                }
            },
        
            play() {
                // Hàm này giờ chỉ để script.js gọi, đảm bảo nhạc phát khi intro bắt đầu
                if (this.audio && this.audio.paused) {
                    // Trả về một Promise để bên ngoài có thể xử lý lỗi
                    return this.audio.play(); 
                }
                // Nếu nhạc đã phát hoặc không tồn tại, trả về một Promise đã hoàn thành
                return Promise.resolve();
            },
        
            // Hàm mới để bật/tắt nhạc từ nút điều khiển
            togglePlayback() {
                if (!this.audio || this.state === 'loading' || this.state === 'error') {
                    console.warn("Nhạc chưa sẵn sàng hoặc đang lỗi.");
                    return;
                }
            
                // Nếu nhạc đang bị tắt tiếng, ưu tiên bật tiếng trước
                if (this.audio.muted) {
                    this.audio.muted = false;
                }
            
                // Sau đó mới xử lý play/pause
                if (this.audio.paused) {
                    this.audio.play();
                } else {
                    this.audio.pause();
                }
            },
        
        
            // --- UI & State Management ---
            updateState(newState) {
                this.state = newState;
                // Chỉ ẩn loader khi không còn loading nữa
                if (newState !== 'loading') {
                    const loader = document.getElementById('music-loader');
                    if(loader) loader.style.display = 'none';
                }
                this.updateUI();
            },
        
            updateUI() {
                const audioIcon = document.getElementById('audio-icon');
                if (!audioIcon) return;
                
                // Cập nhật icon dựa trên trạng thái paused
                if (!this.audio || this.audio.paused) {
                    audioIcon.classList.remove("fa-volume-high");
                    audioIcon.classList.add("fa-volume-xmark");
                } else {
                    audioIcon.classList.remove("fa-volume-xmark");
                    audioIcon.classList.add("fa-volume-high");
                }
            },
        
            attachEventListeners() {
                if (!this.audio) return;
                this.audio.onplay = () => this.updateState('playing');
                this.audio.onpause = () => this.updateState('paused');
                this.audio.onvolumechange = () => this.updateUI(); // Cập nhật UI nếu có thay đổi volume
            },
        
            // Các hàm fetchWithAuth và getToken giữ nguyên...
            async getToken() {
                try {
                    const res = await fetch('/token-api-mp3');
                    if (!res.ok) throw new Error('Không lấy được token');
                    const data = await res.json();
                    this.tokenData = data;
                    return this.tokenData;
                } catch (err) {
                    console.error('Lỗi lấy token:', err);
                    return null;
                }
            },
            async fetchWithAuth(url) {
                await this.getToken();
        
                if (!this.tokenData) throw new Error('Không có token xác thực');
        
                const headers = {
                    'X-Auth-Token': this.tokenData.token,
                    'X-Auth-Timestamp': this.tokenData.timestamp,
                    'X-Client-Key': this.tokenData.clientKey,
                    'X-Auth-Nonce': this.tokenData.nonce,
                };
        
                let res = await fetch(url, {
                    headers
                });
        
                if (!res.ok) {
                    const errorText = await res.text();
                    console.error(`Lỗi response (${res.status}):`, errorText);
                    if (res.status === 403) {
                        await this.getToken();
                        if (!this.tokenData) throw new Error('Không có token xác thực');
        
                        const newHeaders = {
                            'X-Auth-Token': this.tokenData.token,
                            'X-Auth-Timestamp': this.tokenData.timestamp,
                            'X-Client-Key': this.tokenData.clientKey,
                            'X-Auth-Nonce': this.tokenData.nonce,
                        };
        
                        res = await fetch(url, {
                            headers: newHeaders
                        });
        
                        if (!res.ok) {
                            const errText = await res.text();
                            throw new Error(`Request lỗi sau khi refresh token: ${res.status}`);
                        }
                    } else {
                        throw new Error(`Request lỗi: ${res.status}`);
                    }
                }
        
                return res;
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            window.musicManager = musicManager;
            musicManager.init();

            const toggleBtn = document.getElementById("toggle-audio");
            toggleBtn.addEventListener("click", () => musicManager.togglePlayback());
        });
        
        // let tokenData = null;
        // async function getToken() {
        //     try {
        //         const res = await fetch('/token-api-mp3');
        //         if (!res.ok) throw new Error('Không lấy được token');
        //         const data = await res.json();
        //         tokenData = data;
        //         return tokenData;
        //     } catch (err) {
        //         console.error('Lỗi lấy token:', err);
        //         return null;
        //     }
        // }
        // async function fetchWithAuth(url) {
        //     await getToken();
        //     if (!tokenData) throw new Error('Không có token xác thực');
        //     const headers = {
        //         'X-Auth-Token': tokenData.token,
        //         'X-Auth-Timestamp': tokenData.timestamp,
        //         'X-Client-Key': tokenData.clientKey,
        //         'X-Auth-Nonce': tokenData.nonce,
        //     };

        //     let res = await fetch(url, {
        //         headers
        //     });

        //     if (!res.ok) {
        //         // Nếu response lỗi, đọc nội dung lỗi và log
        //         const errorText = await res.text();
        //         console.error(`Lỗi response (${res.status}):`, errorText);
        //         if (res.status === 403) {
        //             await getToken();
        //             if (!tokenData) throw new Error('Không có token xác thực');
        //             const newHeaders = {
        //                 'X-Auth-Token': tokenData.token,
        //                 'X-Auth-Timestamp': tokenData.timestamp,
        //                 'X-Client-Key': tokenData.clientKey,
        //                 'X-Auth-Nonce': tokenData.nonce,
        //             };

        //             res = await fetch(url, {
        //                 headers: newHeaders
        //             });

        //             if (!res.ok) {
        //                 const errText = await res.text();
        //                 // console.error(`Lỗi sau khi refresh token (${res.status}):`, errText);
        //                 throw new Error(`Request lỗi sau khi refresh token: ${res.status}`);
        //             }
        //         } else {
        //             throw new Error(`Request lỗi: ${res.status}`);
        //         }
        //     }

        //     return res;
        // }
        // document.addEventListener('DOMContentLoaded', function() {
        //     const toggleBtn = document.getElementById("toggle-audio");
        //     const audioIcon = document.getElementById("audio-icon");

        //     // Logic lấy nhạc Zing MP3 nếu cần
        //     const initializeMusic = async () => {
        //         const musicData = window.dataLove2Loveloom.data;
        //         if (musicData.type_music === 'zing' && musicData.music_id) {
        //             try {
        //                 const res = await fetchWithAuth(`/get-song?id=${musicData.music_id}`);
        //                 if (!res.ok) throw new Error('Lỗi khi lấy thông tin bài hát');
        //                 const songInfo = await res.json();

        //                 const mp3Url = songInfo.stream?.['128'];
        //                 if (mp3Url) {
        //                     // Cập nhật lại link nhạc trong object global
        //                     window.dataLove2Loveloom.data.backgroundMusic = mp3Url;
        //                     document.dispatchEvent(new CustomEvent('zingMusicReady', {
        //                         detail: {
        //                             url: mp3Url
        //                         }
        //                     }));
        //                     console.log('Đã cập nhật link nhạc Zing:', mp3Url);
        //                 } else {
        //                     console.error('Không tìm thấy link mp3 128kbps từ Zing.');
        //                 }
        //             } catch (error) {
        //                 console.error('Lỗi khi lấy nhạc từ Zing:', error);
        //             }
        //         }
        //     };

        //     // Chạy hàm lấy nhạc Zing ngay khi có thể
        //     initializeMusic();

        //     // Hàm cập nhật icon
        //     const updateAudioIcon = () => {
        //         const audio = window.galaxyAudio; // Tham chiếu đến audio từ script.js
        //         if (!audio || audio.paused || audio.muted) {
        //             audioIcon.classList.remove("fa-volume-high");
        //             audioIcon.classList.add("fa-volume-xmark");
        //         } else {
        //             audioIcon.classList.remove("fa-volume-xmark");
        //             audioIcon.classList.add("fa-volume-high");
        //         }
        //     };

        //     // Xử lý sự kiện click vào nút toggle
        //     toggleBtn.addEventListener("click", () => {
        //         const audio = window.galaxyAudio;
        //         if (!audio) {
        //             console.warn("Vui lòng bắt đầu trải nghiệm để bật/tắt nhạc.");
        //             return;
        //         }
        //         audio.muted = !audio.muted;
        //         if (audio.paused) {
        //             audio.play();
        //         }
        //         updateAudioIcon();
        //     });

        //     // Liên tục kiểm tra và gắn listener khi audio được tạo
        //     setInterval(() => {
        //         const audio = window.galaxyAudio;
        //         if (audio && !audio.dataset.listenersAttached) {
        //             audio.addEventListener('play', updateAudioIcon);
        //             audio.addEventListener('pause', updateAudioIcon);
        //             audio.addEventListener('volumechange', updateAudioIcon);
        //             audio.dataset.listenersAttached = 'true'; // Đánh dấu đã gắn listener
        //             updateAudioIcon();
        //         }
        //     }, 500);
        // });
    </script>
            <script>
            // Chặn chuột phải
            document.addEventListener("contextmenu", function(e) {
                e.preventDefault();
            });

            // Chặn F12, Ctrl+U, Ctrl+Shift+I/J/C/S, Cmd+Opt+I (Mac)
            document.addEventListener("keydown", function(e) {
                if (
                    e.key === "F12" ||
                    (e.ctrlKey && e.shiftKey && ["i", "j", "c", "s"].includes(e.key.toLowerCase())) ||
                    (e.ctrlKey && e.key.toLowerCase() === "u") ||
                    (e.metaKey && e.altKey && e.key.toLowerCase() === "i") || // Cmd + Opt + I
                    (e.metaKey && e.key.toLowerCase() === "u") // Cmd + U
                ) {
                    e.preventDefault();
                    return false;
                }
            });

            // Xóa console methods
            console.log = () => {};
            console.debug = () => {};
            console.warn = () => {};
            console.info = () => {};

            // Phát hiện DevTools bằng thời gian thực thi debugger
            setInterval(() => {
                const before = new Date().getTime();
                debugger;
                const after = new Date().getTime();
                if (after - before > 100) {
                    document.body.innerHTML =
                        '<h1 style="text-align:center;margin-top:100px;color:red">🔒 Bạn đang cố mở Developer Tools!</h1>';
                }
            }, 1000);

            // Phát hiện DevTools qua kích thước cửa sổ
            // function detectDevToolsSize() {
            //     if (
            //         window.outerWidth - window.innerWidth > 160 ||
            //         window.outerHeight - window.innerHeight > 160
            //     ) {
            //         document.body.innerHTML = '<h1 style="text-align:center;margin-top:100px;color:red">🔒 Developer Tools bị phát hiện!</h1>';
            //     }
            // }
            // window.onresize = detectDevToolsSize;
            // window.onload = detectDevToolsSize;

            // Phát hiện mở console qua toString tampering
            (function() {
                const element = new Image();
                Object.defineProperty(element, 'id', {
                    get: function() {
                        document.body.innerHTML =
                            '<h1 style="text-align:center;margin-top:100px;color:red">⚠️ Đừng mở console!</h1>';
                        throw new Error("Console is blocked");
                    }
                });

                setInterval(() => {
                    console.log(element);
                    console.clear();
                }, 2000);
            })();

            // Ngăn inspect element qua mouse drag
            document.addEventListener('dragstart', function(e) {
                e.preventDefault();
            });

            // Ngăn chọn toàn bộ (Ctrl+A)
            document.addEventListener('keydown', function(e) {
                if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'a') {
                    e.preventDefault();
                }
            });
        </script>
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'95426b1ebfdd4a7f',t:'MTc1MDY2NTI3Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='cdn-cgi/challenge-platform/h/g/scripts/jsd/180b6a431d85/maind41d.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="../external.html?link=https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"95426b1ebfdd4a7f","version":"2025.6.2","r":1,"token":"dbcd8856a1a842ceb5c3d63534a9f51d","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}}}' crossorigin="anonymous"></script>
</body>


<!-- Mirrored from love.tsonit.com/sunn by HTTrack Website Copier/3.x [XR&CO'2017], Mon, 23 Jun 2025 07:54:45 GMT -->
</html>
